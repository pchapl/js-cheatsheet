<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/5968/5968292.png" type="image/png">

    <!--    normalize css -->
    <link rel="stylesheet" href="./assets/styles/normalize.css">

    <!-- materialize css -->
    <link rel="stylesheet" href="../node_modules/materialize-css/dist/css/materialize.css">

    <!--    project styles-->
    <link rel="stylesheet" href="./assets/dist/css/main.css">
    <link rel="stylesheet" href="./assets/libraries/highlights/styles/atom-one-light.min.css">

    <!-- material icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


    <title>Web</title> 

</head>

<body>
    <div class="wrapper">
        <header class="header">
            <ul id="dropdown1" class="dropdown-content">
                <li><a href="api.html">API</a></li>
                <li><a href="arrays.html">Arrays</a></li>
                <li><a href="dom.html">DOM</a></li>
                <li><a href="events.html">Events</a></li>
                <li><a href="glossary.html">Glossary</a></li>
                <li><a href="ifelse.html">If Else</a></li>
                <li><a href="prototypes.html">Prototypes</a></li>
                <li><a href="regular.html">Regular</a></li>
                <li><a href="string.html">String</a></li>
                <li><a href="this.html">this</a></li>
                <li><a href="timedate.html">TimeDate</a></li>
                <li><a href="types.html">Types</a></li>
                <li><a href="variables.html">Variables</a></li>
                <li><a href="web.html">Web</a></li>
            </ul>
            <nav class="teal lighten-1">
                <div class="nav-wrapper teal lighten-1 nav__container">
                    <a href="index.html" class="brand-logo left"><img src="./assets/icons8-cherry-100.png" alt="cherry"></a>
                    <ul class="right">
                        <li><a class="dropdown-trigger" href="#" data-target="dropdown1">Разделы:<i
                                class="material-icons right">arrow_drop_down</i></a></li>
                    </ul>
                </div>
            </nav>
        </header>
        <main>
            
            <div class="main__container">
                <h1 class="web__title teal-text text-darken-3">Как работает Web</h1>
                <h3 class="web__title_tiny teal-text text-darken-2">Что делает браузер, чтобы загрузить Веб-страницу?</h3>

                <div class="container">
                    <div class="row">
                        <div class="col s12">

                            <ul class="collection">

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color">account_circle</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Пользователь</h4>
                                            <p class="web__content-text" style="margin-top: 1rem">Вводит адрес сайта в поисковую строку браузера.</p>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_red">dvr</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Браузер</h4>
                                            <p class="web__content-text" style="margin-top: 1rem">Получает адрес. Возьмем для примера <code class="web-code">https://www.google.com</code>. Вот, что в нем есть:</p>
                                            <ul class="web-ul" style="padding-left: 20px">
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">https</code> — это протокол (может быть незащищенный (<code class="web-code">http</code>) или защищённый (<code class="web-code">https</code>));</li>
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">google.com</code> - это <code class="web-code">host</code>, по которому нужно сделать обращение: он представлен доменным именем;</li>
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">/index.html</code> - это адрес ресурса, который нужно получить на веб-сервере.</li>
                                            </ul>
                                            <p class="web__content-text" style="margin-top: 1rem">Браузер делает разбор адреса. Он знает, что машины понимают только цифры. Поэтому берёт <code class="web-code">host</code> и на его основе получает <code class="web-code">IP</code>-адрес (это адрес веб-сервера). Другими словами, происходит преобразование (resolve) доменного имени в <code class="web-code">IP</code>-адрес. Для этого используется <code class="web-code">DNS</code>-сервер (Domain Name Server).</p>
                                            <p class="web__content-text" style="margin-top: 1rem">Однако, если ранее адрес уже использовался, то запрос к <code class="web-code">DNS</code> не делается, потому что эта информация кэшируется. Браузер сначала ищет айпишник в ближайших местах (история подключений, кэш ОС/роутера), и, если находит адрес там, то берет его из локального кэша. Если не находит — отправляет <code class="web-code">host</code> <code class="web-code">DNS</code>-серверу.</p>
                                            <p class="web__content-text"></p>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_amber">storage</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">DNS-сервер</h4>
                                            <p class="web__content-text" style=" margin-top: 1rem">Находит <code class="web-code">IP</code>-адрес сайта в адресной книге и отправляет браузеру.</p>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_red">dvr</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Браузер</h4>
                                            <p class="web__content-text" style="margin-top: 1rem">Получает <code class="web-code">IP</code>-адрес, и теперь можно установить <code class="web-code">TCP</code>-соединение с веб-сервером. <code class="web-code">TCP</code> — это протокол с набором правил, по которым осуществляется соединение. При <code class="web-code">TCP</code>-соединении обязательно подтверждение получения информации: если подтверждение не получено, то информация отправляется заново.</p>
                                            <p class="web__content-text" style="margin-top: 1rem">Для <code class="web-code">TCP</code>-соединения есть важная характеристика: порт, по которому оно должно быть установлено:</p>
                                            <ul class="web-ul" style="padding-left: 20px">
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">80</code> - для <code class="web-code">http</code>-протокола;</li>
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">443</code> - для <code class="web-code">https</code>-протокола.</li>
                                            </ul>
                                            <p class="web__content-text" style="margin-top: 1rem">При установке <code class="web-code">TCP</code>-соединения идет обмен пакетами с флагами <code class="web-code">ACK/SYN/FIN</code>. Если мы взаимодействуем по <code class="web-code">https</code>-протоколу, то происходит так называемое трехстороннее рукопожатие <code class="web-code">TCP</code> (TLS handshake) - это обмен сертификатами, проверка подлинности сертификатов, обмен публичными ключами, т.е. происходит установка доверенного соединения:</p>
                                            <ul class="web-ul" style="padding-left: 20px">
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">SYN</code>-пакет: браузер отправляет запрос на соединение;</li>
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">SYN/ACK</code>-пакет: сервер подтверждает получение;</li>
                                                <li class="web-li" style="list-style-type: disc"><code class="web-code">ACK</code>-пакет: браузер подтверждает, что получил <code class="web-code">SYN/ACK</code>-пакет.</li>
                                            </ul>
                                            
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_cyan">sync</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Соединение установлено</h4>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_red">dvr</i>
                                        <div class="web__content">
                                            <div>
                                                <h4 class="web__content-title">Браузер</h4>
                                                <p class="web__content-text style" style="margin-top: 1rem">Когда соединение установлено, мы переходим к <code class="web-code">http</code>http-части.</p>
                                                <p class="web__content-text style" style="margin-top: 1rem">Браузер объясняет серверу, что ему нужно: формирует <code class="web-code">http</code>-заголовок.</p>
                                                <p class="web__content-text style" style="margin-top: 1rem">Это простой текстовый заголовок. Он включает в себя: метод получения информации (<code class="web-code">GET/POST</code> или другие), <code class="web-code">URL</code>, версию <code class="web-code">http</code>-протокола, которая используется клиентом, <code class="web-code">host</code>, <code class="web-code">connection</code> (чаще всего <code class="web-code">close</code>), <code class="web-code">cookie</code> и т.п.</p>
                                                <p class="web__content-text style" style="margin-top: 1rem">Можно отметить, что до версии <code class="web-code">http</code>-протокола <code class="web-code">1.0</code> не было поддержки виртуальных хостов и нельзя было указать такой заголовок, как <code class="web-code">host</code>. Начиная с версии <code class="web-code">1.0</code> почти везде используются виртуальные веб-сервера, когда можно на одном веб-сервере хостить несколько веб-серверов, разделенных по хостам. Поэтому в <code class="web-code">http</code>-заголовке указывается заголовок <code class="web-code">host</code> и имя хоста, которое, как правило, совпадает с доменным именем.</p>
                                                <p class="web__content-text style" style="margin-top: 1rem">После формирования <code class="web-code">http</code>-заголовка браузер отправляет его серверу.</p>
                                            </div>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_cyan">dns</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Сервер</h4>
                                            <p class="web__content-text" style="margin-top: 1rem">Веб-сервер получает заголовок и производит обработку, формирует ответ и отправляет браузеру.</p>
                                            <p class="web__content-text" style="margin-top: 1rem">Ответом может быть:</p>
                                            <ul class="web-ul" style="padding-left: 20px">
                                                <li class="web-li" style="list-style-type: disc">в случае успеха — заголовок со <code class="web-code">status code: 200</code> и <code class="web-code">html</code>-страница;</li>
                                                <li class="web-li" style="list-style-type: disc">в случае ошибки — сообщение об ошибке.</li>
                                            </ul>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color_red">dvr</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Браузер</h4>
                                            <p class="web__content-text" style="margin-top: 1rem">Если пришел заголовок со <code class="web-code">status code: 200</code>, браузер берет полученную <code class="web-code">html</code>-страницу (которая приходит в пакетах данных) и делает парсинг (сбор данных).</p>
                                            <p class="web__content-text" style="margin-top: 1rem"><code class="web-code">HTML</code> - достаточно сложный язык, он не парсится в один проход. Части парсинга:</p>
                                            <ul class="web-ul" style="padding-left: 20px">
                                                <li class="web-li" style="list-style-type: disc">лексический анализ — выделение лексем, токенов;</li>
                                                <li class="web-li" style="list-style-type: disc">синтаксический анализ — проверка правильности самого языка;</li>
                                                <li class="web-li" style="list-style-type: disc">парсинг — формирование дерева распарсенных элементов.</li>
                                            </ul>
                                            <p class="web__content-text" style="margin-top: 1rem">При парсинге <code class="web-code">HTML</code> создаются <code class="web-code">DOM</code>, <code class="web-code">CSSOM</code> и непосредственно <code class="web-code">Render tree</code> с набором элементов, на основе которого происходит отображение страницы. Процесс рендеринга — это и есть постепенное отображение контента на экране.</p>
                                            <p class="web__content-text" style="margin-top: 1rem">Если на странице есть скрипты, они могут изменять положение элементов, их размер. В таком случае запускаются дополнительные процессы парсинга.</p>
                                            <p class="web__content-text" style="margin-top: 1rem">Наконец, происходит отображение страницы на основе распарсенной информации.</p>
                                        </div>
                                    </div>
                                </li>

                                <li class="collection-item avatar">
                                    <div class="web__card">
                                        <i class="medium material-icons web__icon-color">account_circle</i>
                                        <div class="web__content">
                                            <h4 class="web__content-title">Пользователь</h4>
                                            <p class="web__content-text" style="margin-top: 1rem">Видит страницу и взаимодействует с ней.</p>
                                        </div>
                                    </div>
                                </li>
                                
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="web-block">
                <h3 class="web__title_medium">Запросы в действии</h3>
                <div class="web-block__item">
                    <p class="web__content-text" style="margin-top: 1rem">JavaScript дает нам возможность самостоятельно составлять и отправлять запросы на сервер. Чтобы протестировать взаимодействие с сервером и посмотреть на его ответ, сделаем <code class="web-code">fetch</code>-запрос к открытому <code class="web-code">API</code> гифок <a href="https://developers.giphy.com/explorer/" target="_blank">GIPHY</a> и попробуем получить картинку. Подробнее о работе <code class="web-code">API</code> и <code class="web-code">fetch</code>-запросах можно <a href="./api.html">прочитать здесь.</a></p>
                <p>Пусть это будет простой <code class="web-code">GET</code>-запрос без указания дополнительных параметров:</p>
                <pre>
                    <code>
async function loadData() {
    let response = await fetch("https://api.giphy.com/v1/gifs/translate?api_key=вставить_API_Key_с_сайта_GIPHY=cat");
    let data = await response.json();

    try {
        if(response.status === 200){
            // здесь пишем код, который должен вывести на странице гифку, status code и response headers              
        } else {
            throw new Error ("Проверьте корректность запроса.");
        }           
    } catch (error) {
        console.log(error.message);
        // а здесь пишем код, который должен вывести на страницу сообщение об ошибке
    }
}
loadData();
                    </code>
                </pre>
                <p class="web__content-text" style="margin-top: 1rem">На основе шаблона функции <code class="web-code">loadData()</code> смоделированы две ситуации:</p>
                <ul class="web-ul" style="padding-left: 20px">
                    <li class="web-li" style="list-style-type: disc">успешный запрос: <code class="web-code">fetch</code>-запрос составлен верно, вместо фразы "вставить_API_Key_с_сайта_GIPHY" был добавлен актуальный ключ;</li>
                    <li class="web-li" style="list-style-type: disc">запрос с ошибкой: а здесь ключ добавлен не был, в таком виде <code class="web-code">fetch</code> некорректен — запросу не хватает учетных данных.</li>
                </ul>
                <p class="web__content-text" style="margin-top: 1rem">Чтобы узнать, сработает ли запрос, какой статус и какие заголовки придут с сервера в параметрах ответа <code class="web-code">response.status</code> и <code class="web-code">response.headers</code>, нажмите на кнопку "Посмотреть гифку":</p>
                </div>
                

                <div class="web-result-items">
                    <div class="card-panel col s12 teal lighten-5 web-result-item">
                        <h4 class="web__title_small">Успешный запрос</h4>
                        <div class="web-request">
                            <button class="waves-effect waves-light btn web-button web-button-success">Посмотреть гифку</button>
                            <div class="web-request__result">
                                <div class="web-status-success"></div>
                                <div class="web-headers-success"></div>
                                <div class="web-header-success"></div>
                                <div class="web-gif-success"></div></div>
                        </div>
                    </div>
                    <div class="card-panel col s12 red lighten-5 web-result-item">
                        <h4 class="web__title_small">Запрос с ошибкой</h4>
                        <div class="web-request">
                            <button class="waves-effect waves-light btn web-button web-button-unsuccess red lighten-1">Посмотреть гифку</button>
                            <div class="web-request__result">
                                <div class="web-status-unsuccess"></div>
                                <div class="web-headers-unsuccess"></div>
                                <div class="web-header-unsuccess"></div>
                                <div class="web-gif-unsuccess"></div>
                            </div>
                            
                        </div>
                    </div>
                </div>
                <div class="web-links">
                    <h2 class="teal-text text-darken-2">Полезные ссылки</h2>
                        <p><a class="grey-text text-darken-1" href="https://itgirlschool.notion.site/Web-59f96a212416461aae187345db4271e8">Как работает Web</a></p>
                        <p><a class="grey-text text-darken-1" href="https://medium.com/genesis-media/что-стоит-за-простой-загрузкой-веб-странички-в-браузере-3933c96467a">Что стоит за простой загрузкой веб-странички в браузере</a></p>
                        <p><a class="grey-text text-darken-1"
                                   href="https://www.youtube.com/watch?v=ylG8_d9Qk1U">Что делает браузер, чтобы загрузить Веб-страницу? <i class="tiny material-icons">smart_display</i></a></p>
                </div>
                </div>

            </div>
        </main>
        <footer class="page-footer teal lighten-1">
            <div class="container">
                <div class="row">
                    <div class="col l6 s12">
                        <div>
                            <h3 class="white-text">Random joke <span class="material-icons">sentiment_satisfied_alt</span>
                            </h3>
                            <div>
                                <div class="setup"></div>
                                <div class="punchline"></div>
                                <div class="error"></div>
                            </div>
                        </div>
                        <a href="index.html" class="brand-logo left"><img src="./assets/icons8-cherry-100.png" alt="cherry"></a>
                    </div>
                    <div class="col l4 offset-l2 s12">
                        <h3 class="white-text">Полезные ссылки</h3>
                        <ul>
                            <li><a class="grey-text text-lighten-3"
                                   href="https://itgirlschool.notion.site/Frontend34-64b1b279b00f4fe7884dc4d9ec6afffc">Notion
                                Frontend 34</a></li>
                            <li><a class="grey-text text-lighten-3" href="https://learn.javascript.ru/">Современный учебник
                                JavaScript</a></li>
                            <li><a class="grey-text text-lighten-3"
                                   href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference">Справочник по
                                JavaScript. MDN</a></li>
                            <li><a class="grey-text text-lighten-3"
                                   href="https://www.youtube.com/playlist?list=PLqKQF2ojwm3l4oPjsB9chrJmlhZ-zOzWT">Сложный
                                JavaScript простым языком <i class="tiny material-icons">smart_display</i></a></li>
                            <li><a class="grey-text text-lighten-3" href="https://doka.guide/js/">JavaScript Дока</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-copyright">
                <div class="container">
                    © 2023
                    <a class="grey-text text-lighten-4 right" href="about.html">О прекрасных разработчицах этого гайда</a>
                </div>
            </div>
        </footer>
    </div>


    <script src="./assets/dist/js/main.js"></script>
    <script src="./assets/libraries/highlights/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>